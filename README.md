# Gasoline Prices Analysis: La Laguna Region, Mexico

This repository contains an empirical analysis of gasoline price evolution and distribution in the La Laguna region (Torreón and Gómez Palacio municipalities) in Mexico following the deregulation of the gasoline market in 2017.

## Overview

The analysis examines retail gasoline prices for three products (regular, premium, and diesel) from June 15, 2017 onwards, covering 808 days of price data across 154 gas stations. The study investigates:

- **Price levels**: Factors affecting retail gasoline prices
- **Price dispersion**: Determinants of price variation across stations
- **Competition effects**: Impact of competitor density and spatial competition
- **Brand effects**: Influence of brand identity and same-brand market share
- **Station characteristics**: Effects of amenities (convenience stores, ATMs, car washes) and location (road type, municipality)

## Repository Structure

### Main Analysis Scripts

- **`cleaning.R`**: Data cleaning and preparation pipeline
  - Filters data to post-deregulation period (from June 15, 2017)
  - Removes non-reporting stations
  - Computes competitor density within 2km radius
  - Merges station characteristics (brand, location, amenities)
  - Calculates distance to nearest competitor

- **`descriptive statistics and plots.R`**: Exploratory data analysis
  - Generates descriptive statistics tables
  - Creates visualizations: quantile plots, standard deviation plots, terminal price plots
  - Analyzes price distributions by year, product, and station characteristics
  - Correlation analysis by time period

- **`regressions.R`**: Econometric analysis
  - **Price level regressions**: Panel data models (random effects) explaining retail prices
  - **Price dispersion regressions**: Lewis method using Prais-Winsten estimator with panel-corrected standard errors (PCSE)
  - Serial correlation tests (Breusch-Godfrey)
  - Separate analyses by product (regular, premium, diesel) and year (2017, 2018, 2019)

- **`regression_tables.R`**: Generates publication-ready regression tables
  - Formats regression results using `stargazer` and `texreg`
  - Exports LaTeX tables for price level and dispersion regressions

- **`denue.R`**: Spatial data enrichment
  - Uses INEGI DENUE API to obtain establishment counts and postal codes
  - Enriches station data with neighborhood characteristics

### Functions Directory

Custom functions for data processing and visualization:

- **`limpieza.R`**: Removes non-reporting stations and stations with extended periods without price changes
- **`densidad.R`**: Computes competitor density within specified radius for each station-date combination
- **`sdplot.R`**: Standard deviation plots over time
- **`quantplot.R`**: Quantile plots of price distributions
- **`terminalplot.R`**: Terminal (wholesale) price plots
- **`pdplot.R`**: Price-density relationship plots
- **`multiplot.R`**: Utility for combining multiple plots
- **`getmode.R`**: Statistical utility function

### Data Requirements

The analysis expects the following data files (not included in repository):

- `data/laguna_prices.rds`: Raw price data
- `data/gast.xlsx`: Station characteristics for Torreón
- `data/gasgp.xlsx`: Station characteristics for Gómez Palacio
- `data/denue.RData`: DENUE spatial data (generated by `denue.R`)

## Methodology

### Data Structure
- **Panel data**: Station (`code`) × Date (`date`) × Product (`product`)
- **Time period**: June 15, 2017 - September 2019 (808 days)
- **Products**: Regular, Premium, Diesel
- **Stations**: 154 stations across Torreón (68.3%) and Gómez Palacio (31.7%)

### Key Variables

**Dependent Variables:**
- `price_end`: Retail price
- `disp`: Price dispersion (log of squared residuals from auxiliary regression)

**Explanatory Variables:**
- `price_term`: Terminal (wholesale) price
- `density`: Number of competitors within 2km radius
- `same_brand_share`: Share of competitors with same brand
- `min_dist`: Distance to nearest competitor
- `Brand`: Station brand (Pemex, OXXO Gas, Mi Gasolina, etc.)
- `Road.Type`: Location type (avenue, highway, street)
- `Convenience.Store`, `ATM`, `Car.Wash`: Binary indicators for amenities
- `zip_code`, `muni_name`: Geographic controls

### Econometric Methods

1. **Price Level Regressions**: Panel random effects models with robust standard errors (SCC)
2. **Price Dispersion Regressions**: Panel AR(1) models with panel-corrected standard errors (PCSE)
3. **Serial Correlation**: Breusch-Godfrey tests for residual autocorrelation

## Dependencies

### R Packages

```r
tidyverse, openxlsx, geosphere, magrittr, plm, stats, utils, 
lubridate, corrplot, pcse, panelAR, scales, readxl, extrafont, 
fastDummies, treemapify, stargazer, texreg, inegiR
```

## Usage

1. **Data Preparation**: Run `cleaning.R` to generate cleaned dataset (`data/clean_prices.RData`)
2. **Auxiliary Regression**: Run `descriptive statistics and plots.R` to generate auxiliary regression residuals (`data/final_prices.RData`)
3. **Main Analysis**: Run `regressions.R` to perform price level and dispersion regressions
4. **Tables**: Run `regression_tables.R` to generate publication-ready regression tables

## Key Findings

The analysis examines how competition density, brand effects, station characteristics, and spatial factors influence both the level and dispersion of gasoline prices in the post-deregulation Mexican gasoline market.

## Author

Alejandro Hernandez Gonzalez (2019-2020)

